solvee(int **dd/*to receive colors*/)
{
 int pp,s,k,*k1,i,j,*f3,f4,f5,f6,f7,f8,*h[6],q,f[3][3],b[3][3],t[3][3],bt[3][3],l[3][3],r[3][3];
 hidemptr();
 for(i=0;i<=2;i++)
 {
 for(j=0;j<=2; j++)
 {
 f[i][j]=*(*dd+3*i+j);
 b[i][j]=*(*(dd+1)+3*i+j);
 t[i][j]=*(*(dd+2)+3*i+j);
 bt[i][j]=*(*(dd+3)+3*i+j);
 l[i][j]=*(*(dd+4)+3*i+j);
 r[i][j]=*(*(dd+5)+3*i+j);
 }}
h[0]=&f[0][0];
h[1]=&b[0][0];
h[2]=&t[0][0];
h[3]=&bt[0][0];
h[4]=&l[0][0];
h[5]=&r[0][0];
sh();
cleardevice();
 pol(h);
 color(h);
 f3=dv(&h[0]);
 if(*(f3+1)==3)
  {
  x1(&h[0]);
  }
  if(*(f3+1)==1)
  {
  x1(&h[0]);
  x1(&h[0]);
  }
  if(*(f3+1)==2)
  {
  x2(&h[0]);
  }
  if(*(f3+1)==4)
  {
  y2(&h[0]);
  }
  if(*(f3+1)==5)
  {
  y1(&h[0]);
  }
			  //   step   i
 /////////////////////////////////////////////////////////////////////////////
 /////////////////////////////////////////////////////////////////////////////
 for(i=0;i<=4;i++)
 {

 if(f[1][1]==r[2][1]&&bt[1][1]==bt[1][2])
 {
 do2(&h[0]);
 }


 if(f[1][1]==bt[1][2]&&bt[1][1]==r[2][1])
 {
 r2(&h[0]);
 b2(&h[0]);
 r1(&h[0]);
 do2(&h[0]);
 do2(&h[0]);
 }


 if(f[1][1]==b[2][1]&&bt[1][1]==bt[2][1])
 {
 do2(&h[0]);
 do2(&h[0]);

 }

 if(f[1][1]==bt[2][1]&&bt[1][1]==b[2][1])
 {
 b1(&h[0]);
 r1(&h[0]);
 do2(&h[0]);
 r2(&h[0]);
 }

 if(f[1][1]==l[2][1]&&bt[1][1]==bt[1][0])
 {
 do1(&h[0]);
 }


  if(f[1][1]==bt[1][0]&&bt[1][1]==l[2][1])
 {
 do2(&h[0]);
 b1(&h[0]);
 r1(&h[0]);
 do2(&h[0]);
 r2(&h[0]);

 }


 if(f[1][1]==bt[0][1]&&bt[1][1]==f[2][1])
 {
 do2(&h[0]);
 do2(&h[0]);
 b1(&h[0]);
 r1(&h[0]);
 do2(&h[0]);
 r2(&h[0]);
 }



 if(f[1][1]==t[1][2]&&bt[1][1]==r[0][1])
 {
 f2(&h[0]);
 r2(&h[0]);
 f1(&h[0]);
 }



 if(f[1][1]==r[0][1]&&bt[1][1]==t[1][2])
 {
 r1(&h[0]);
 r1(&h[0]);
 do2(&h[0]);
 r1(&h[0]);
 r1(&h[0]);
 }


 if(f[1][1]==r[1][2]&&bt[1][1]==b[1][0])
 {
 r1(&h[0]);
 do2(&h[0]);
 r2(&h[0]);
 }


 if(f[1][1]==b[1][0]&&bt[1][1]==r[1][2])
 {
 b2(&h[0]);
 do1(&h[0]);
 do1(&h[0]);
 }


 if(f[1][1]==r[1][0]&&bt[1][1]==f[1][2])
 {
 r2(&h[0]);
 do2(&h[0]);
 }


 if(bt[1][1]==r[1][0]&&f[1][1]==f[1][2])
 {
 r1(&h[0]);
 r1(&h[0]);
 b2(&h[0]);
 do2(&h[0]);
 do2(&h[0]);
 }


 if(f[1][1]==t[0][1]&&bt[1][1]==b[0][1])
 {
 b2(&h[0]);
 r1(&h[0]);
 do2(&h[0]);
 r2(&h[0]);
 }


 if(bt[1][1]==t[0][1]&&f[1][1]==b[0][1])
 {
 b1(&h[0]);
 b1(&h[0]);
 do2(&h[0]);
 do2(&h[0]);
 }


 if(f[1][1]==t[1][0]&&bt[1][1]==l[0][1])
 {
 l2(&h[0]);
 b1(&h[0]);
 do1(&h[0]);
 do1(&h[0]);
 l1(&h[0]);
 }


 if(bt[1][1]==t[1][0]&&f[1][1]==l[0][1])
 {
 l2(&h[0]);
 l2(&h[0]);
 do1(&h[0]);
 l2(&h[0]);
 l2(&h[0]);
 }



 if(f[1][1]==t[2][1]&&bt[1][1]==f[0][1])
 {
 u2(&h[0]);
 f2(&h[0]);
 r2(&h[0]);
 f1(&h[0]);
 }


 if(bt[1][1]==t[2][1]&&f[1][1]==f[0][1])
 {
 u2(&h[0]);
 r2(&h[0]);
 r2(&h[0]);
 do2(&h[0]);
 r2(&h[0]);
 r2(&h[0]);
 }


 if(f[1][1]==f[1][0]&&bt[1][1]==l[1][2])
 {
 l1(&h[0]);
 f1(&h[0]);
 l2(&h[0]);
 f2(&h[0]);
 }

 if(bt[1][1]==f[1][0]&&f[1][1]==f[1][2])
 {
 l1(&h[0]);
 do1(&h[0]);
 do2(&h[0]);
 r2(&h[0]);
 r2(&h[0]);
 }


 if(f[1][1]==l[1][0]&&bt[1][1]==b[1][2])
 {
 l2(&h[0]);
 do1(&h[0]);
 l1(&h[0]);
 }


 if(bt[1][1]==l[1][0]&&f[1][1]==b[1][2])
 {
 l1(&h[0]);
 f1(&h[0]);
 l1(&h[0]);
 f2(&h[0]);
 l2(&h[0]);
 l2(&h[0]);
 }

 z1(&h[0]);

 }
x2(&h[0]);
			//  step ii
///////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////
for(i=0;i<3;i++)
{
if(f[1][1]==l[0][0]&&r[1][1]==t[0][0]&&bt[1][1]==b[0][2])
{
r1(&h[0]);
b2(&h[0]);
r2(&h[0]);
u2(&h[0]);
r1(&h[0]);
u2(&h[0]);
r2(&h[0]);
u2(&h[0]);
u2(&h[0]);
r1(&h[0]);
u1(&h[0]);
r2(&h[0]);
}

if(f[1][1]==f[2][0]&&r[1][1]==l[2][2]&&bt[1][1]==bt[0][0])
{
do2(&h[0]);
b2(&h[0]);
b2(&h[0]);
r1(&h[0]);
b1(&h[0]);
r2(&h[0]);
do1(&h[0]);
}

if(f[1][1]==r[0][2]&&bt[1][1]==t[0][2]&&r[1][1]==b[0][0])
{
do2(&h[0]);
b2(&h[0]);
b2(&h[0]);
r1(&h[0]);
b1(&h[0]);
r2(&h[0]);
do1(&h[0]);
}

if(f[1][1]==t[2][2]&&r[1][1]==r[0][0]&&bt[1][1]==f[0][2])
{
f2(&h[0]);
u2(&h[0]);
f1(&h[0]);
}

if(f[1][1]==f[0][2]&&r[1][1]==t[2][2]&&bt[1][1]==r[0][0])
{
r1(&h[0]);
u1(&h[0]);
r2(&h[0]);
}

if(f[1][1]==r[0][0]&&r[1][1]==f[0][2]&&bt[1][1]==t[2][2])
{
r1(&h[0]);
u2(&h[0]);
r2(&h[0]);
u2(&h[0]);
u2(&h[0]);
r1(&h[0]);
u1(&h[0]);
r2(&h[0]);
}

if(f[1][1]==t[2][0]&&r[1][1]==f[0][0]&&bt[1][1]==l[0][2])
{
u2(&h[0]);
f2(&h[0]);
u2(&h[0]);
f1(&h[0]);
}

if(f[1][1]==t[0][0]&&r[1][1]==l[0][0]&&bt[1][1]==b[0][2])
{
u2(&h[0]);
u2(&h[0]);
f2(&h[0]);
u2(&h[0]);
f1(&h[0]);
}

if(f[1][1]==t[0][2]&&r[1][1]==b[0][0]&&bt[1][1]==r[0][2])
{
u1(&h[0]);
f2(&h[0]);
u2(&h[0]);
f1(&h[0]);
}

if(f[1][1]==l[0][2]&&r[1][1]==t[2][0]&&bt[1][1]==f[0][0])
{
u2(&h[0]);
r1(&h[0]);
u1(&h[0]);
r2(&h[0]);
}

if(f[1][1]==t[0][0]&&r[1][1]==l[0][0]&&bt[1][1]==b[0][2])
{
u2(&h[0]);
u2(&h[0]);
f2(&h[0]);
u2(&h[0]);
f1(&h[0]);
}
if(f[1][1]==b[0][2]&&r[1][1]==t[0][0]&&bt[1][1]==l[0][0])
{
u2(&h[0]);
u2(&h[0]);
r1(&h[0]);
u1(&h[0]);
r2(&h[0]);
}
if(f[1][1]==l[0][0]&&r[1][1]==b[0][2]&&bt[1][1]==t[0][0])
{
u2(&h[0]);
u2(&h[0]);
r1(&h[0]);
u2(&h[0]);
r2(&h[0]);
u2(&h[0]);
u2(&h[0]);
r1(&h[0]);
u1(&h[0]);
r2(&h[0]);
}
if(f[1][1]==b[0][2]&&r[1][1]==t[0][0]&&bt[1][1]==l[0][0])
{
u2(&h[0]);
u2(&h[0]);
r1(&h[0]);
u1(&h[0]);
r2(&h[0]);
}
if(f[1][1]==r[0][2]&&r[1][1]==t[0][2]&&bt[1][1]==b[0][0])
{
u1(&h[0]);
r1(&h[0]);
u1(&h[0]);
r2(&h[0]);
}

if(f[1][1]==f[0][0]&&r[1][1]==l[0][2]&&bt[1][1]==t[2][0])
{
u2(&h[0]);
r1(&h[0]);
u2(&h[0]);
r2(&h[0]);
u2(&h[0]);
u2(&h[0]);
r1(&h[0]);
u1(&h[0]);
r2(&h[0]);
}

if(f[1][1]==l[0][0]&&r[1][1]==b[0][2]&&bt[1][1]==t[0][0])
{
u2(&h[0]);
u2(&h[0]);
r1(&h[0]);
u2(&h[0]);
r2(&h[0]);
u2(&h[0]);
u2(&h[0]);
r1(&h[0]);
u1(&h[0]);
r2(&h[0]);
}
//problem
if(f[1][1]==b[0][0]&&r[1][1]==r[0][2]&&bt[1][1]==t[0][2])
{

u1(&h[0]);
r1(&h[0]);
u2(&h[0]);
r2(&h[0]);
u2(&h[0]);
u2(&h[0]);
r1(&h[0]);
u1(&h[0]);
r2(&h[0]);
}


if(f[1][1]==r[2][0]&&r[1][1]==bt[0][2]&&bt[1][1]==f[2][2])
{

do2(&h[0]);
l2(&h[0]);
u2(&h[0]);
l1(&h[0]);
do1(&h[0]);
u1(&h[0]);
r1(&h[0]);
u2(&h[0]);
r2(&h[0]);
}


if(f[1][1]==l[2][2]&&r[1][1]==f[2][0]&&bt[1][1]==bt[0][0])
{
l2(&h[0]);
u2(&h[0]);
l1(&h[0]);
r1(&h[0]);
u1(&h[0]);
r2(&h[0]);
}


if(f[1][1]==f[2][0]&&r[1][1]==bt[0][0]&&bt[1][1]==l[2][2])
{
l2(&h[0]);
u2(&h[0]);
l1(&h[0]);
f2(&h[0]);
u2(&h[0]);
f1(&h[0]);
}

if(f[1][1]==bt[0][0]&&r[1][1]==l[2][2]&&bt[1][1]==f[2][0])
{
l2(&h[0]);
u2(&h[0]);
l1(&h[0]);
r1(&h[0]);
u2(&h[0]);
r2(&h[0]);
u2(&h[0]);
u2(&h[0]);
r1(&h[0]);
u1(&h[0]);
r2(&h[0]);
}


if(f[1][1]==b[2][2]&&r[1][1]==l[2][0]&&bt[1][1]==bt[2][0])
{
l1(&h[0]);
u1(&h[0]);
l2(&h[0]);
u1(&h[0]);
f2(&h[0]);
u2(&h[0]);
f1(&h[0]);
}


if(f[1][1]==l[2][0]&&r[1][1]==bt[2][0]&&bt[1][1]==b[2][2])
{
l1(&h[0]);
u1(&h[0]);
l2(&h[0]);
u1(&h[0]);
r1(&h[0]);
u2(&h[0]);
r2(&h[0]);
u2(&h[0]);
u2(&h[0]);
r1(&h[0]);
u1(&h[0]);
r2(&h[0]);
}


if(f[1][1]==bt[2][0]&&r[1][1]==b[2][2]&&bt[1][1]==l[2][0])
{
l1(&h[0]);
u1(&h[0]);
l2(&h[0]);
u1(&h[0]);
r1(&h[0]);
u1(&h[0]);
r2(&h[0]);
}


if(f[1][1]==bt[2][2]&&r[1][1]==r[2][2]&&bt[1][1]==b[2][0])
{
r2(&h[0]);
u2(&h[0]);
r1(&h[0]);
u2(&h[0]);
u2(&h[0]);
r1(&h[0]);
u2(&h[0]);
r2(&h[0]);
u2(&h[0]);
u2(&h[0]);
r1(&h[0]);
u1(&h[0]);
r2(&h[0]);
}

if(f[1][1]==r[2][2]&&r[1][1]==b[2][0]&&bt[1][1]==bt[2][2])
{
r2(&h[0]);
u2(&h[0]);
r1(&h[0]);
u2(&h[0]);
u2(&h[0]);
r1(&h[0]);
u1(&h[0]);
r2(&h[0]);
}

if(f[1][1]==b[2][0]&&r[1][1]==bt[2][2]&&bt[1][1]==r[2][2])
{
r2(&h[0]);
u2(&h[0]);
r1(&h[0]);
u2(&h[0]);
u2(&h[0]);
f2(&h[0]);
u2(&h[0]);
f1(&h[0]);
}

if(f[1][1]==bt[0][2]&&r[1][1]==f[2][2]&&bt[1][1]==r[2][0])
{
r1(&h[0]);
u1(&h[0]);
r2(&h[0]);
u2(&h[0]);
r1(&h[0]);
u1(&h[0]);
r2(&h[0]);
}

if(f[1][1]==r[2][0]&&r[1][1]==bt[0][2]&&bt[1][1]==f[2][2])
{
r1(&h[0]);
u1(&h[0]);
r2(&h[0]);
u2(&h[0]);
r1(&h[0]);
u2(&h[0]);
r2(&h[0]);
u2(&h[0]);
u2(&h[0]);
r1(&h[0]);
u1(&h[0]);
r2(&h[0]);
}
y2(&h[0]);
}
y2(&h[0]);
		//  step  iii
//////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////
for(i=0;i<=2;i++)
{
if(i==1)
do2(&h[0]);
if(i==2)
do2(&h[0]);
if(f[1][1]==f[0][1]&&r[1][1]==t[2][1])
 {

 u2(&h[0]);

 do2(&h[0]);


 f2(&h[0]);
 u1(&h[0]);
 f1(&h[0]);
 do1(&h[0]);
 }


 if(f[1][1]==r[0][1]&&r[1][1]==t[1][2])
 {
 do2(&h[0]);
 f2(&h[0]);
 u1(&h[0]);
 f1(&h[0]);
 do1(&h[0]);
 }


 if(f[1][1]==t[2][1]&&r[1][1]==f[0][1])
 {
 do2(&h[0]);
 r1(&h[0]);
 u2(&h[0]);
 r2(&h[0]);
 do1(&h[0]);
 }

 if(f[1][1]==t[1][2]&&r[1][1]==r[0][1])
 {
 u1(&h[0]);
 do2(&h[0]);
 r1(&h[0]);
 u2(&h[0]);
 r2(&h[0]);
 do1(&h[0]);
 }


 if(f[1][1]==l[0][1]&&r[1][1]==t[1][0])
 {
 u2(&h[0]);
 u2(&h[0]);
 do2(&h[0]);
 f2(&h[0]);
 u1(&h[0]);
 f1(&h[0]);
 do1(&h[0]);
 }



 if(f[1][1]==t[1][0]&&r[1][1]==l[0][1])
 {
 u2(&h[0]);
 do2(&h[0]);
 r1(&h[0]);
 u2(&h[0]);
 r2(&h[0]);
 do1(&h[0]);
 }

 if(f[1][1]==t[0][1]&&r[1][1]==b[0][1])
 {
 u1(&h[0]);
 u1(&h[0]);
 do2(&h[0]);
 r1(&h[0]);
 u2(&h[0]);
 r2(&h[0]);
 do1(&h[0]);
 }


 if(f[1][1]==b[0][1]&&r[1][1]==t[0][1])
 {
 u1(&h[0]);
 do2(&h[0]);
 f2(&h[0]);
 u1(&h[0]);
 f1(&h[0]);
 do1(&h[0]);
 }



  if(f[1][1]==r[1][0]&&r[1][1]==f[1][2])
 {
 do2(&h[0]);
 r1(&h[0]);
 u1(&h[0]);
 r2(&h[0]);
 u2(&h[0]);
 f2(&h[0]);
 u1(&h[0]);
 f1(&h[0]);
 do1(&h[0]);
 }


 if(f[1][1]==l[1][2]&&r[1][1]==f[1][0])
 {
 do2(&h[0]);
 do2(&h[0]);
 f1(&h[0]);
 u2(&h[0]);
 f2(&h[0]);
 u1(&h[0]);
 do1(&h[0]);
 r1(&h[0]);
 u2(&h[0]);
 r2(&h[0]);
 do1(&h[0]);
 }


 if(f[1][1]==f[1][0]&&r[1][1]==l[1][2])
 {
 do2(&h[0]);
 do2(&h[0]);
 f1(&h[0]);
 u2(&h[0]);
 f2(&h[0]);
 do1(&h[0]);
 f2(&h[0]);
 u1(&h[0]);
 f1(&h[0]);
 do1(&h[0]);
 }


 if(f[1][1]==b[1][0]&&r[1][1]==r[1][2])
 {
 r2(&h[0]);
 u1(&h[0]);
 r1(&h[0]);
 do2(&h[0]);
 r1(&h[0]);
 u2(&h[0]);
 r2(&h[0]);
 do1(&h[0]);
 }

 if(f[1][1]==r[1][2]&&r[1][1]==b[1][0])
 {
 r2(&h[0]);
 u1(&h[0]);
 r1(&h[0]);
 u2(&h[0]);
 do2(&h[0]);
 f2(&h[0]);
 u1(&h[0]);
 f1(&h[0]);
 do1(&h[0]);
 }

 if(f[1][1]==l[1][0]&&r[1][1]==b[1][2])
 {
 do1(&h[0]);
 l1(&h[0]);
 u1(&h[0]);
 l2(&h[0]);
 do2(&h[0]);
 do2(&h[0]);
 u1(&h[0]);
 f2(&h[0]);
 u1(&h[0]);
 f1(&h[0]);
 do1(&h[0]);
 }


 if(f[1][1]==b[1][2]&&r[1][1]==l[1][0])
 {
 do1(&h[0]);
 l1(&h[0]);
 u2(&h[0]);
 l2(&h[0]);
 do2(&h[0]);
 do2(&h[0]);
 r1(&h[0]);
 u2(&h[0]);
 r2(&h[0]);
 do1(&h[0]);
 }
 y2(&h[0]);
 }
 do1(&h[0]);
 do1(&h[0]);
 y1(&h[0]);
 y2(&h[0]);
		//  step  iv (a)
 /////////////////////////////////////////////////////////////////////////////
 /////////////////////////////////////////////////////////////////////////////
if(f[1][1]==t[2][2]&&r[1][1]==r[0][0]&&bt[1][1]==f[0][2])
{
f2(&h[0]);
u2(&h[0]);
f1(&h[0]);
}
if(f[1][1]==r[0][0]&&r[1][1]==f[0][2]&&bt[1][1]==t[2][2])
{

r1(&h[0]);
u2(&h[0]);
r2(&h[0]);
u2(&h[0]);
u2(&h[0]);
r1(&h[0]);
u1(&h[0]);
r2(&h[0]);
}



if(f[1][1]==f[0][2]&&r[1][1]==t[2][2]&&bt[1][1]==r[0][0])
{

r1(&h[0]);
u1(&h[0]);
r2(&h[0]);

}

if(f[1][1]==r[0][2]&&r[1][1]==t[0][2]&&bt[1][1]==b[0][0])
{
u1(&h[0]);
r1(&h[0]);
u1(&h[0]);
r2(&h[0]);
}

if(f[1][1]==b[0][2]&&r[1][1]==t[0][0]&&bt[1][1]==l[0][0])
{

u2(&h[0]);
u2(&h[0]);
r1(&h[0]);
u1(&h[0]);
r2(&h[0]);

}



if(f[1][1]==l[0][2]&&r[1][1]==t[2][0]&&bt[1][1]==f[0][0])
{

u2(&h[0]);
r1(&h[0]);
u1(&h[0]);
r2(&h[0]);

}




if(f[1][1]==t[0][2]&&r[1][1]==b[0][0]&&bt[1][1]==r[0][2])
{

u1(&h[0]);
f2(&h[0]);
u2(&h[0]);
f1(&h[0]);

}


if(f[1][1]==t[0][0]&&r[1][1]==l[0][0]&&bt[1][1]==b[0][2])
{

u1(&h[0]);
u1(&h[0]);
f2(&h[0]);
u2(&h[0]);
f1(&h[0]);

}


if(f[1][1]==t[2][0]&&r[1][1]==f[0][0]&&bt[1][1]==l[0][2])
{

u2(&h[0]);
f2(&h[0]);
u2(&h[0]);
f1(&h[0]);

}




if(f[1][1]==b[0][0]&&r[1][1]==r[0][2]&&bt[1][1]==t[0][2])
{

u1(&h[0]);
r1(&h[0]);
u2(&h[0]);
r2(&h[0]);
u2(&h[0]);
u2(&h[0]);
r1(&h[0]);
u1(&h[0]);
r2(&h[0]);
}


if(f[1][1]==l[0][0]&&r[1][1]==b[0][2]&&bt[1][1]==t[0][0])
{

u2(&h[0]);
u2(&h[0]);
r1(&h[0]);
u2(&h[0]);
r2(&h[0]);
u2(&h[0]);
u2(&h[0]);
r1(&h[0]);
u1(&h[0]);
r2(&h[0]);
}




if(f[1][1]==f[0][0]&&r[1][1]==l[0][2]&&bt[1][1]==t[2][0])
{

u2(&h[0]);
r1(&h[0]);
u2(&h[0]);
r2(&h[0]);
u2(&h[0]);
u2(&h[0]);
r1(&h[0]);
u1(&h[0]);
r2(&h[0]);
}


if((f[1][1]==r[2][0]&&r[1][1]==bt[0][2]&&bt[1][1]==f[2][2])||(f[1][1]==bt[0][2]&&r[1][1]==f[2][2]&&bt[1][1]==r[2][0]))
{

r1(&h[0]);
u1(&h[0]);
r2(&h[0]);




if(f[1][1]==l[0][2]&&r[1][1]==t[2][0]&&bt[1][1]==f[0][0])
{

u2(&h[0]);
r1(&h[0]);
u1(&h[0]);
r2(&h[0]);

}


if(f[1][1]==f[0][0]&&r[1][1]==l[0][2]&&bt[1][1]==t[2][0])
{

u2(&h[0]);
r1(&h[0]);
u2(&h[0]);
r2(&h[0]);
u2(&h[0]);
u2(&h[0]);
r1(&h[0]);
u1(&h[0]);
r2(&h[0]);

}
}
			// step iv (b)
//////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////

if(f[1][1]==t[1][2]&&r[1][1]==r[0][1])
{

u2(&h[0]);
f2(&h[0]);
u1(&h[0]);
f1(&h[0]);
u1(&h[0]);
r1(&h[0]);
u2(&h[0]);
r2(&h[0]);
 }




 if(f[1][1]==f[0][1]&&r[1][1]==t[2][1])
{

u1(&h[0]);
r1(&h[0]);
u2(&h[0]);
r2(&h[0]);
u2(&h[0]);
f2(&h[0]);
u1(&h[0]);
f1(&h[0]);
}


if(f[1][1]==t[2][1]&&r[1][1]==f[0][1])
{

u2(&h[0]);
u2(&h[0]);
f2(&h[0]);
u1(&h[0]);
f1(&h[0]);
u1(&h[0]);
r1(&h[0]);
u2(&h[0]);
r2(&h[0]);
}

if(f[1][1]==t[1][0]&&r[1][1]==l[0][1])
{

u1(&h[0]);
f2(&h[0]);
u1(&h[0]);
f1(&h[0]);
u1(&h[0]);
r1(&h[0]);
u2(&h[0]);
r2(&h[0]);

}


if(f[1][1]==t[0][1]&&r[1][1]==b[0][1])
{

f2(&h[0]);
u1(&h[0]);
f1(&h[0]);
u1(&h[0]);
r1(&h[0]);
u2(&h[0]);
r2(&h[0]);
}

if(f[1][1]==r[0][1]&&r[1][1]==t[1][2])
{

u1(&h[0]);
u1(&h[0]);
r1(&h[0]);
u2(&h[0]);
r2(&h[0]);
u2(&h[0]);
f2(&h[0]);
u1(&h[0]);
f1(&h[0]);

}


if(f[1][1]==b[0][1]&&r[1][1]==t[0][1])
{

u2(&h[0]);
r1(&h[0]);
u2(&h[0]);
r2(&h[0]);
u2(&h[0]);
f2(&h[0]);
u1(&h[0]);
f1(&h[0]);

}


if(f[1][1]==l[0][1]&&r[1][1]==t[1][0])
{

r1(&h[0]);
u2(&h[0]);
r2(&h[0]);
u2(&h[0]);
f2(&h[0]);
u1(&h[0]);
f1(&h[0]);

}
if(f[1][1]==r[1][0]&&r[1][1]==f[1][2])
{
r1(&h[0]);
u2(&h[0]);
r2(&h[0]);
y2(&h[0]);
u1(&h[0]);
r2(&h[0]);
u1(&h[0]);
u1(&h[0]);
r1(&h[0]);
u2(&h[0]);
u2(&h[0]);
r2(&h[0]);
u1(&h[0]);
r1(&h[0]);
}
			// step v(a)
/////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////
for(i=0;i<=3;i++)
{
if(f[0][1]==t[1][1]&&r[0][1]==t[1][1])
{
f1(&h[0]);
u1(&h[0]);
r1(&h[0]);
u2(&h[0]);
r2(&h[0]);
f2(&h[0]);
}
if(f[0][1]==t[1][1]&&b[0][1]==t[1][1])
{
f1(&h[0]);
r1(&h[0]);
u1(&h[0]);
r2(&h[0]);
u2(&h[0]);
f2(&h[0]);
}


y1(&h[0]);

}             // step v(b)
/////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////
for(i=0;i<=3;i++)
{
if(f[0][1]==l[1][1]&&l[0][1]==b[1][1]&&b[0][1]==r[1][1]&&r[0][1]==f[1][1])
{
u1(&h[0]);
break;
}
if(f[0][1]==r[1][1]&&r[0][1]==b[1][1]&&b[0][1]==l[1][1]&&l[0][1]==f[1][1])
{
u2(&h[0]);
break;
}
//new step included
if(f[1][1]!=f[0][1]&&r[1][1]!=r[0][1]&&b[1][1]!=b[0][1]&&l[1][1]!=l[0][1])
u1(&h[0]);

if(r[0][1]==l[1][1]&&l[0][1]==f[1][1]&&f[0][1]==r[1][1])
{
r2(&h[0]);
u2(&h[0]);
u2(&h[0]);
r1(&h[0]);
u1(&h[0]);
r2(&h[0]);
u1(&h[0]);
r1(&h[0]);

}



if(l[0][1]==r[1][1]&&r[0][1]==f[1][1]&&f[0][1]==l[1][1])
{
r2(&h[0]);
u2(&h[0]);
r1(&h[0]);
u2(&h[0]);
r2(&h[0]);
u2(&h[0]);
u2(&h[0]);
r1(&h[0]);

}


//check this step
if(l[0][1]==b[1][1]&&b[0][1]==l[1][1])
{
u1(&h[0]);
r2(&h[0]);
u2(&h[0]);
u2(&h[0]);
r1(&h[0]);
u1(&h[0]);
r2(&h[0]);
u1(&h[0]);
r1(&h[0]);
}

if(b[0][1]==f[1][1]&&f[0][1]==b[1][1])
{
r2(&h[0]);
u2(&h[0]);
u2(&h[0]);
r1(&h[0]);

u1(&h[0]);
r2(&h[0]);
u1(&h[0]);
r1(&h[0]);

u2(&h[0]);

r2(&h[0]);
u2(&h[0]);
u2(&h[0]);
r1(&h[0]);
u1(&h[0]);
r2(&h[0]);
u1(&h[0]);
r1(&h[0]);
}
y1(&h[0]);
}
			//step 6
/////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////


for(i=0;i<=3;i++)
{
if(((t[2][2]==t[1][1]&&r[0][0]==l[1][1]&&f[0][2]==b[1][1])||(t[2][2]==b[1][1]&&r[0][0]==t[1][1]&&f[0][2]==l[1][1])||(t[2][2]==l[1][1]&&r[0][0]==b[1][1]&&f[0][2]==t[1][1]))&&((t[0][0]==t[1][1]&&l[0][0]==r[1][1]&&b[0][2]==f[1][1])||(t[0][0]==r[1][1]&&l[0][0]==f[1][1]&&b[0][2]==t[1][1])||(t[0][0]==f[1][1]&&l[0][0]==t[1][1]&&b[0][2]==r[1][1])))
{
y1(&h[0]);
if(((t[2][2]==t[1][1]&&r[0][0]==l[1][1]&&f[0][2]==b[1][1])||(t[2][2]==b[1][1]&&r[0][0]==t[1][1]&&f[0][2]==l[1][1])||(t[2][2]==l[1][1]&&r[0][0]==b[1][1]&&f[0][2]==t[1][1]))&&((t[0][0]==t[1][1]&&l[0][0]==r[1][1]&&b[0][2]==f[1][1])||(t[0][0]==r[1][1]&&l[0][0]==f[1][1]&&b[0][2]==t[1][1])||(t[0][0]==f[1][1]&&l[0][0]==t[1][1]&&b[0][2]==r[1][1])))
{
r2(&h[0]);
r2(&h[0]);
l2(&h[0]);
l2(&h[0]);
do1(&h[0]);
r2(&h[0]);
r2(&h[0]);
l2(&h[0]);
l2(&h[0]);
u2(&h[0]);
u2(&h[0]);

r2(&h[0]);
r2(&h[0]);
l2(&h[0]);
l2(&h[0]);
do1(&h[0]);
r2(&h[0]);
r2(&h[0]);
l2(&h[0]);
l2(&h[0]);
u2(&h[0]);
u2(&h[0]);
}
}

for(i=0;i<=3;i++)
{
if(((t[0][0]==b[1][1]&&l[0][0]==r[1][1]&&b[0][2]==t[1][1])||(t[0][0]==r[1][1]&&l[0][0]==t[1][1]&&b[0][2]==b[1][1])||(t[0][0]==t[1][1]&&l[0][0]==b[1][1]&&b[0][2]==r[1][1]))&&((t[0][2]==b[1][1]&&r[0][2]==l[1][1]&&b[0][0]==t[1][1])||(t[0][2]==t[1][1]&&r[0][2]==b[1][1]&&b[0][0]==l[1][1])||(t[0][2]==l[1][1]&&r[0][2]==t[1][1]&&b[0][0]==b[1][1])))
{
y1(&h[0]);
y1(&h[0]);
if(((t[0][0]==b[1][1]&&l[0][0]==r[1][1]&&b[0][2]==t[1][1])||(t[0][0]==r[1][1]&&l[0][0]==t[1][1]&&b[0][2]==b[1][1])||(t[0][0]==t[1][1]&&l[0][0]==b[1][1]&&b[0][2]==r[1][1]))&&((t[0][2]==b[1][1]&&r[0][2]==l[1][1]&&b[0][0]==t[1][1])||(t[0][2]==t[1][1]&&r[0][2]==b[1][1]&&b[0][0]==l[1][1])||(t[0][2]==l[1][1]&&r[0][2]==t[1][1]&&b[0][0]==b[1][1])))
{
y1(&h[0]);
y1(&h[0]);
f1(&h[0]);
r1(&h[0]);
u1(&h[0]);
r2(&h[0]);
u2(&h[0]);
r1(&h[0]);
u1(&h[0]);
r2(&h[0]);
u2(&h[0]);
r1(&h[0]);
u1(&h[0]);

r2(&h[0]);
u2(&h[0]);
f2(&h[0]);
}
}
y1(&h[0]);
}

for(i=0;i<=3;i++)
{

if(((t[2][0]==r[1][1]&&f[0][0]==t[1][1]&&l[0][2]==b[1][1])||(t[2][0]==t[1][1]&&f[0][0]==b[1][1]&&l[0][2]==r[1][1])||(t[2][0]==b[1][1]&&f[0][0]==r[1][1]&&l[0][2]==t[1][1]))&&((t[0][2]==f[1][1]&&r[0][2]==r[1][1]&&b[0][0]==t[1][1])||(t[0][2]==r[1][1]&&r[0][2]==t[1][1]&&b[0][0]==f[1][1])||(t[0][2]==t[1][1]&&r[0][2]==f[1][1]&&b[0][0]==r[1][1]))&&((f[0][2]==t[1][1]&&r[0][0]==l[1][1]&&t[2][2]==f[1][1])||(f[0][2]==l[1][1]&&r[0][0]==f[1][1]&&t[2][2]==t[1][1])||(f[0][2]==f[1][1]&&r[0][0]==t[1][1]&&t[2][2]==l[1][1])))
{



r2(&h[0]);
u1(&h[0]);
l1(&h[0]);
u2(&h[0]);
r1(&h[0]);
u1(&h[0]);
l2(&h[0]);
u2(&h[0]);
}


if(((t[2][2]==r[1][1]&&f[0][2]==b[1][1]&&r[0][0]==t[1][1])||(t[2][2]==b[1][1]&&f[0][2]==t[1][1]&&r[0][0]==r[1][1])||(t[2][2]==t[1][1]&&f[0][2]==r[1][1]&&r[0][0]==b[1][1]))&&((f[0][0]==r[1][1]&&t[2][0]==t[1][1]&&l[0][2]==f[1][1])||(f[0][0]==t[1][1]&&t[2][0]==f[1][1]&&l[0][2]==r[1][1])||(f[0][0]==f[1][1]&&t[2][0]==r[1][1]&&l[0][2]==t[1][1]))&&((t[0][2]==f[1][1]&&r[0][2]==t[1][1]&&b[0][0]==l[1][1])||(t[0][2]==l[1][1]&&r[0][2]==f[1][1]&&b[0][0]==t[1][1])||(t[0][2]==t[1][1]&&r[0][2]==l[1][1]&&b[0][0]==f[1][1])))
{
u1(&h[0]);
l1(&h[0]);
u2(&h[0]);
r2(&h[0]);
u1(&h[0]);
l2(&h[0]);
u2(&h[0]);
r1(&h[0]);
}
y1(&h[0]);

}
y1(&h[0]);
}

				//step7
/////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////
for(i=0;i<=10;i++)
{
if(t[2][2]==r[1][1]&&f[0][2]==t[1][1]&&r[0][0]==f[1][1])
{
if(t[0][2]!=t[1][1])
{
y1(&h[0]);
u2(&h[0]);
f1(&h[0]);
do2(&h[0]);
do2(&h[0]);
f2(&h[0]);
r2(&h[0]);
do2(&h[0]);
do2(&h[0]);
r1(&h[0]);
u1(&h[0]);
r2(&h[0]);
do2(&h[0]);
do2(&h[0]);
r1(&h[0]);
f1(&h[0]);
do2(&h[0]);
do2(&h[0]);
f2(&h[0]);
}
else
{
f1(&h[0]);
do2(&h[0]);
do2(&h[0]);
f2(&h[0]);
r2(&h[0]);
do2(&h[0]);
do2(&h[0]);
r1(&h[0]);
u2(&h[0]);
r2(&h[0]);
do2(&h[0]);
do2(&h[0]);
r1(&h[0]);
f1(&h[0]);
do2(&h[0]);
do2(&h[0]);
f2(&h[0]);
u1(&h[0]);
}
}

if(t[2][2]==f[1][1]&&f[0][2]==r[1][1]&&r[0][0]==t[1][1])
{
if(t[0][2]!=t[1][1])
{
y1(&h[0]);
f1(&h[0]);
do2(&h[0]);
do2(&h[0]);
f2(&h[0]);
r2(&h[0]);
do2(&h[0]);
do2(&h[0]);
r1(&h[0]);
u2(&h[0]);
r2(&h[0]);
do2(&h[0]);
do2(&h[0]);
r1(&h[0]);
f1(&h[0]);
do2(&h[0]);
do2(&h[0]);
f2(&h[0]);
u1(&h[0]);
}
else
{
u2(&h[0]);
f1(&h[0]);
do2(&h[0]);
do2(&h[0]);
f2(&h[0]);
r2(&h[0]);
do2(&h[0]);
do2(&h[0]);
r1(&h[0]);
u1(&h[0]);
r2(&h[0]);
do2(&h[0]);
do2(&h[0]);
r1(&h[0]);
f1(&h[0]);
do2(&h[0]);
do2(&h[0]);
f2(&h[0]);
}
}
y1(&h[0]);
}
getch();
hidemptr();
return(0);
}
				//solution over
/////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////
